<!DOCTYPE html>
<html lang="en">
    <head>
        <title>{%block title%}{%endblock%} AgeTube</title>
        <link rel = "stylesheet" href="{{url_for('static',filename='style.css')}}">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@400;700&display=swap" rel="stylesheet">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">    
    </head>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="agetube" href="/">AgeTube</a>
    </nav>
    <body>
        <div id="faceio-modal"></div>
    </body>
        <div class = "container">
            <div class = "datos">
                <center><h1>Crea una cuenta</h1></center>
                <center><p>Es facilito uwu</p></center>
                <hr>
                <form  method='POST' class="needs-validation" id ="formulario" novalidate><!--Ingresar los datos-->
                    <div>
                        <input  type ="text" class="form-control" id ="nombre" name="nombre" placeholder="Nombre" required/>
                        <div class="invalid-feedback">No te pusieron nombre? (✖╭╮✖) </div>
                        <div class="valid-feedback">Bien hecho ʕ•ܫ•ʔ</div>
                    </div>
                    <div>
                        <input  type ="text" class="form-control" id ="apellido" name="apellido" placeholder="Apellidos" required/>
                        <div class="invalid-feedback">Apoco te vas sin decirme tu apellido? ╭( ◕﹏◕ )╮ </div>
                        <div class="valid-feedback">Que obediente (ノ^_^)ノ</div>
                    </div>
                    <div>
                        <input  type ="mail" class="form-control" id ="correo" name="correo" placeholder="Correo electronico"  onkeyup= "confMail()" required/>
                        <p id="electronico"></p>
                        <div class="valid-feedback">Enorgulleces a tu familia (づ ᴖ ɜ ᴖ)づ</div>
                    </div>
                    <div>
                        <input type="text" class="form-control"  id ="Username" name="Username" placeholder="Username" aria-label="Username" aria-describedby="basic-addon1">
                    </div>
                    <div>
                        <input  type ="password" class="form-control" id ="password" name="password" placeholder="Contraseña"  data-bs-toggle="tooltip" 
                        data-bs-title="Debe contar con: Mayusculas, Caracter especial, Dígitos, Minúsculas y Mínimo 8 caracterés" onkeyup= "valida()" required/>
                        <p id="requisitos"></p>
                        <div class="valid-feedback"></div>
                        <div class="invalid-feedback"></div>
                    </div>
                    <div>
                        <input  type ="password" class="form-control" id ="confirma" name="confirma" placeholder="Confirma tu contraseña" onkeyup= "coincide()" required/>
                        <p id="simon"></p>
                        <div class="valid-feedback"></div>
                        <div class="invalid-feedback"></div>
                    </div>
                    <div>
                        <input type ="text" class="form-control" id ="determinada" name="determinada" placeholder="Edad estimada" readonly/>
                        <div class="valid-feedback"></div>
                        <div class="invalid-feedback"></div>
                    </div>
                    <p>Fecha de nacimiento</p>
                    <div class = "tres">
                        <div class = "datosf" id="fecha">
                            <select class="muted" id="dia" name ="dia" data-bs-toggle="tooltip" data-bs-title="Día">
                                <option> 1 </option>
                                <option> 2 </option>
                                <option> 3 </option>
                                <option> 4 </option>
                                <option> 5 </option>
                                <option> 6 </option>
                                <option> 7 </option>
                                <option> 8 </option>
                                <option> 9 </option>
                                <option> 10 </option>
                                <option> 11 </option>
                                <option> 12 </option>
                                <option> 13 </option>
                                <option> 14 </option>
                                <option> 15 </option>
                                <option> 16 </option>
                                <option> 17 </option>
                                <option> 18 </option>
                                <option> 19 </option>
                                <option> 20 </option>
                                <option> 21 </option>
                                <option> 22 </option>
                                <option> 23 </option>
                                <option> 24 </option>
                                <option> 25 </option>
                                <option> 26 </option>
                                <option> 27 </option>
                                <option> 28 </option>
                                <option> 29 </option>
                                <option> 30 </option>
                                <option value=31 selected>31</option>
                            </select>
                        </div>
                        <div class = "datosf" id="fecha">
                            <select class="muted" id="mes" name ="mes" data-bs-toggle="tooltip" data-bs-title="Mes">
                                <option> 1 </option>
                                <option> 2 </option>
                                <option> 3 </option>
                                <option> 4 </option>
                                <option> 5 </option>
                                <option> 6 </option>
                                <option> 7 </option>
                                <option> 8 </option>
                                <option> 9 </option>
                                <option> 10 </option>
                                <option> 11 </option>
                                <option value=12 selected> 12 </option>
                            </select>
                        </div>
                        <div class = "datosf" id="fecha">
                            <select class="muted" id="anio" name ="anio" data-bs-toggle="tooltip" data-bs-title="Año">
                                <option> 1910 </option>
                                <option> 1911 </option>
                                <option> 1912 </option>
                                <option> 1913 </option>
                                <option> 1914 </option>
                                <option> 1915 </option>
                                <option> 1916 </option>
                                <option> 1917 </option>
                                <option> 1918 </option>
                                <option> 1919 </option>
                                <option> 1920 </option>
                                <option> 1921 </option>
                                <option> 1922 </option>
                                <option> 1923 </option>
                                <option> 1924 </option>
                                <option> 1925 </option>
                                <option> 1926 </option>
                                <option> 1927 </option>
                                <option> 1928 </option>
                                <option> 1929 </option>
                                <option> 1930 </option>
                                <option> 1931 </option>
                                <option> 1932 </option>
                                <option> 1933 </option>
                                <option> 1934 </option>
                                <option> 1935 </option>
                                <option> 1936 </option>
                                <option> 1937 </option>
                                <option> 1938 </option>
                                <option> 1939 </option>
                                <option> 1940 </option>
                                <option> 1941 </option>
                                <option> 1942 </option>
                                <option> 1943 </option>
                                <option> 1944 </option>
                                <option> 1945 </option>
                                <option> 1946 </option>
                                <option> 1947 </option>
                                <option> 1948 </option>
                                <option> 1949 </option>
                                <option> 1950 </option>
                                <option> 1951 </option>
                                <option> 1952 </option>
                                <option> 1953 </option>
                                <option> 1954 </option>
                                <option> 1955 </option>
                                <option> 1956 </option>
                                <option> 1957 </option>
                                <option> 1958 </option>
                                <option> 1959 </option>
                                <option> 1960 </option>
                                <option> 1961 </option>
                                <option> 1962 </option>
                                <option> 1963 </option>
                                <option> 1964 </option>
                                <option> 1965 </option>
                                <option> 1966 </option>
                                <option> 1967 </option>
                                <option> 1968 </option>
                                <option> 1969 </option>
                                <option> 1970 </option>
                                <option> 1971 </option>
                                <option> 1972 </option>
                                <option> 1973 </option>
                                <option> 1974 </option>
                                <option> 1975 </option>
                                <option> 1976 </option>
                                <option> 1977 </option>
                                <option> 1978 </option>
                                <option> 1979 </option>
                                <option> 1980 </option>
                                <option> 1981 </option>
                                <option> 1982 </option>
                                <option> 1983 </option>
                                <option> 1984 </option>
                                <option> 1985 </option>
                                <option> 1986 </option>
                                <option> 1987 </option>
                                <option> 1988 </option>
                                <option> 1989 </option>
                                <option> 1990 </option>
                                <option> 1991 </option>
                                <option> 1992 </option>
                                <option> 1993 </option>
                                <option> 1994 </option>
                                <option> 1995 </option>
                                <option> 1996 </option>
                                <option> 1997 </option>
                                <option> 1998 </option>
                                <option> 1999 </option>
                                <option value=2000 selected> 2000 </option>
                                <option> 2001 </option>
                                <option> 2002 </option>
                                <option> 2003 </option>
                                <option> 2004 </option>
                                <option> 2005 </option>
                                <option> 2006 </option>
                                <option> 2007 </option>
                                <option> 2008 </option>
                                <option> 2009 </option>
                                <option> 2010 </option>
                                <option> 2011 </option>
                                <option> 2012 </option>
                                <option> 2013 </option>
                                <option> 2014 </option>
                                <option> 2015 </option>
                                <option> 2016 </option>
                                <option> 2017 </option>
                                <option> 2018 </option>
                                <option> 2019 </option>
                                <option> 2020 </option>
                                <option> 2021 </option>
                                <option> 2022 </option>
                            </select>
                        </div>
                    </div>
                    <p>Género</p>
                    <div class = "tres">
                        <div class = "datosg">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" value="Mujer" name="genero" id="genero">
                                <label class="form-check-label" for="flexRadioDefault1">
                                    Mujer
                                </label>
                            </div>
                        </div>
                        <div class = "datosg">
                            <div class="form-check">
                                <input class="form-check-input" type="radio"  value="Hombre" name="genero" id="genero">
                                <label class="form-check-label" for="flexRadioDefault1">
                                    Hombre
                                </label>
                            </div></div>
                        <div class = "datosg">   
                            <input class="form-check-input" type="radio" value="Nobin" name="genero" id="genero">
                            <label class="form-check-label" for="flexRadioDefault1">
                                No binarie
                            </label>
                             </div>
                    </div>
                    <br>
                    <br>
                    <div class="text-center">
                        <div>
                            <input type="submit" value="Registrate" id = "btnreg"/>
                        </div>
                    </div>
                </form>
                <div>
                    <input type="submit" onclick="enrollNewUser()" value="Determina tu edad" id="DetEdad" />
                </div>
            </div>
        </div>
 
        <script src="https://cdn.faceio.net/fio.js"></script>
        <script type="text/javascript"><!-- validar contrseña-->
            var mayus = new RegExp("^(?=.*[A-Z])");
            var especial = new RegExp("^(?=.*[!@#$&*%^])");
            var numeros = new RegExp("^(?=.*[0-9])");
            var lower = new RegExp("^(?=.*[a-z])");
            var len = new RegExp("^(?=.{8,})");
            var emailRegex = /^[-\w.%+]{1,64}@(?:[A-Z0-9-]{1,63}\.){1,125}[A-Z]{2,63}$/i;
            var determinada = 0;

            const btnr = document.getElementById('btnreg');
            const faceio = new faceIO("fioa0162");
            btnr.disabled = true;

            function valida (){
                var pass = document.getElementById('password').value;
                if(mayus.test(pass) && especial.test(pass) && numeros.test(pass) && lower.test(pass) && len.test(pass)){
                    document.getElementById('requisitos').innerHTML = "Contraseña segura, bien hecho (屮ಠ益ಠ)屮 ";
                }else{
                    document.getElementById('requisitos').innerHTML = "Contraseña débil, usuario débil ʕ•ܫ•ʔ ";
                }
            }

            function coincide (){
                var pass = document.getElementById('password').value;
                var conf = document.getElementById('confirma').value;
                if(pass == conf){
                    document.getElementById('simon').innerHTML = "Identicas como tus... (づ ᴖ ɜ ᴖ)づ";
                }else{
                    document.getElementById('simon').innerHTML = "Como que no se parecen homs UnU";
                }
            }

            function confMail(){
                var cor = document.getElementById('correo').value;
                if(emailRegex.test(cor)){
                    document.getElementById('electronico').innerHTML = "";
                }else{
                    document.getElementById('electronico').innerHTML = "Esto no parece un correo electronico (¬_¬)";
                }
            }
            // Instantiate fio.js with your application Public ID
            function enrollNewUser(){
               // Start the facial enrollment process
               faceio.enroll({
                    "locale": "auto", // Default user locale
                    "payload": {
                    /* The payload we want to associate with this user
                    * which is forwarded back to us upon future
                    * authentication of this particular user.*/
                    }
                }).then(userInfo => {
                    // User Successfully Enrolled!
                    alert(
                        `Se registro el rostro correctamente:
                        Fecha de registro: ${userInfo.timestamp}
                        Edad aproximada: ${userInfo.details.age}
                        Por favor ingresa una fecha de nacimiento 
                        segun la edad determinada
                        (mayor o menor de edad)`
                    );
                    console.log(userInfo);
                    determinada = userInfo.details.age;
                    console.log(determinada);
                    document.getElementById('determinada').value= determinada;
                    btnr.disabled = false;
                    document.getElementById('DetEdad').disabled=true;
                }).catch(errCode => {
                    // handle enrollment failure. Visit:
                    // https://faceio.net/integration-guide#error-codes
                    // for the list of all possible error codes
                })
            }
            
        </script>
    </body>
</html>